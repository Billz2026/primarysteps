<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Spelling Practice</title>
<link rel="icon" href="assets/primary-steps-icon-512.png">
<style>
body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;background:#0b0d12;color:#eef2ff}
header{background:#121621;padding:14px;border-bottom:1px solid rgba(255,255,255,.1)}
main{max-width:900px;margin:auto;padding:24px}
.card{background:#121621;border:1px solid rgba(255,255,255,.1);border-radius:18px;padding:20px}
.word{font-size:42px;font-weight:900;text-align:center;margin:20px 0}
input{width:100%;padding:12px;border-radius:14px;border:1px solid rgba(255,255,255,.2);background:#0b0d12;color:#eef2ff;font-size:18px;text-align:center}
button{margin-top:12px;padding:10px 16px;border-radius:999px;border:1px solid rgba(255,255,255,.2);background:rgba(255,255,255,.06);color:#eef2ff;font-weight:800;cursor:pointer}
.msg{margin-top:12px;padding:10px;border-radius:12px;background:rgba(255,255,255,.05)}
.good{border:1px solid rgba(52,211,153,.4)}
.bad{border:1px solid rgba(251,113,133,.4)}
</style>
</head>
<body>
<header><a href="spelling.html" style="color:#7dd3fc;text-decoration:none;font-weight:800">← Back to Spelling</a></header>
<main>
  <div class="card">
    <h1 id="title">Spelling</h1>
    <div class="word" id="word"></div>
    <input id="input" placeholder="Type the spelling">
    <button onclick="check()">Check</button>
    <button onclick="next()">Next</button>
    <div class="msg" id="msg">Press Check</div>
  </div>
</main>

<script>
const WORDS = {
  easy:["cat","dog","sun","hat","pen","cup","bus","run","fox","pig","map","red","box","top","jam","milk","fish","tree","moon","star","book","rain","snow","ball","hand","foot","sock","bike","cake","duck","frog","ship","ring","sand","lamp","nest"],
  medium:["apple","banana","orange","school","teacher","window","garden","family","happy","friend","pencil","picture","playing","reading","writing","number","letters","phonics","outside","inside","morning","evening","birthday","holiday","animals","cooking","shopping","helpful","different","important","because","between","together","suddenly","another"],
  hard:["beautiful","adventure","information","communication","confidence","imagination","experience","responsible","comfortable","interesting","mathematics","concentration","determination","extraordinary","environment","independent","improvement","celebration","development","opportunity","temperature","electricity","government","photograph","knowledge","understanding","relationship","experiment","competition","organisation","character","especially","dictionary","calendar","necessary","immediately"]
};

const params = new URLSearchParams(location.search);
const mode = (params.get("mode")||"lcwc").toLowerCase();

const titleEl = document.getElementById("title");
const wordEl  = document.getElementById("word");
const inputEl = document.getElementById("input");
const msgEl   = document.getElementById("msg");

const levelCycle = ["easy","medium","hard"];
let levelIndex = 0;
let level = "easy";
let current = "";
let masked = "";

// Helpers
function pick(arr){ return arr[Math.floor(Math.random()*arr.length)]; }
function padWordDisplay(str){
  // add spaces between characters for readability
  return str.split("").join(" ");
}
function makeMask(word, blanks){
  // Ensure unique blank indexes, avoid first letter blank for confidence on easy.
  const idxs = new Set();
  const len = word.length;
  const avoid = new Set([0]); // keep first letter as hint
  while(idxs.size < blanks){
    const i = Math.floor(Math.random()*len);
    if(avoid.has(i)) continue;
    idxs.add(i);
    // for very short words, allow first letter if needed
    if(len <= 3 && idxs.size < blanks) avoid.delete(0);
  }
  const chars = word.split("");
  idxs.forEach(i => chars[i] = "_");
  return chars.join("");
}

function setModeUI(){
  if(mode === "missing"){
    titleEl.textContent = "Missing Letters";
    inputEl.placeholder = "Type the full word";
    msgEl.textContent = "Look at the hints, then type the full word.";
  }else{
    titleEl.textContent = "Look, Cover, Write";
    inputEl.placeholder = "Type the spelling";
    msgEl.textContent = "Read the word, then type it.";
  }
}

function next(){
  level = levelCycle[levelIndex % 3];
  levelIndex++;

  const list = WORDS[level];
  current = pick(list).toLowerCase();

  inputEl.value = "";
  msgEl.className = "msg";

  if(mode === "missing"){
    // blanks by difficulty (cap so it stays possible)
    const blanks = (level==="easy") ? 1 : (level==="medium" ? 2 : 3);
    const b = Math.min(blanks, Math.max(1, current.length - 2));
    masked = makeMask(current, b);
    wordEl.textContent = padWordDisplay(masked.toUpperCase());
    msgEl.textContent = `Level: ${level.toUpperCase()} • Fill the missing letters and type the whole word.`;
  }else{
    wordEl.textContent = current.toUpperCase();
    msgEl.textContent = `Level: ${level.toUpperCase()} • Read the word, then type it.`;
  }
}

function check(){
  const val = inputEl.value.trim().toLowerCase();
  if(!val){
    msgEl.textContent = "Type your answer first.";
    msgEl.className = "msg";
    return;
  }
  if(val === current){
    msgEl.textContent = "✅ Correct!";
    msgEl.className = "msg good";
  }else{
    msgEl.textContent = `Not quite. Try again.`;
    msgEl.className = "msg bad";
  }
}

// Expose for inline onclick (keeps your current buttons working)
window.next = next;
window.check = check;

// Enter key to check
inputEl.addEventListener("keydown", (e)=>{
  if(e.key === "Enter") check();
});

setModeUI();
next();
</script>
</body>
</html>
