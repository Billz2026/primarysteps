<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Memory Match – Primary Steps</title>
  <style>
    :root{
      --bg:#0b0d12;
      --panel:#121621;
      --panel2:#0f1320;
      --text:#eef2ff;
      --muted:#a9b2c7;
      --brand:#7dd3fc;
      --accent:#a78bfa;
      --good:#34d399;
      --warn:#fbbf24;
      --border:rgba(255,255,255,.10);
      --radius:18px;
      --shadow:0 12px 40px rgba(0,0,0,.35);
    }
    *{box-sizing:border-box}
    html,body{margin:0;height:100%}
    body{
      font-family: system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      background:
        radial-gradient(900px 520px at 20% 0%, rgba(125,211,252,.18), transparent 60%),
        radial-gradient(900px 520px at 85% 20%, rgba(167,139,250,.18), transparent 60%),
        var(--bg);
      color:var(--text);
    }

    /* Header (uniform) */
    header{
      position:sticky; top:0; z-index:10;
      backdrop-filter: blur(12px);
      background: rgba(18,22,33,.75);
      border-bottom:1px solid var(--border);
    }
    .topbar{
      max-width:1150px; margin:auto;
      padding:12px 18px;
      display:flex; align-items:center; justify-content:space-between; gap:12px;
    }
    .brand{
      display:flex; align-items:center; gap:12px;
      text-decoration:none; color:var(--text);
    }
    .brand img{
      height:52px; width:auto;
      filter:drop-shadow(0 10px 25px rgba(125,211,252,.25));
    }
    .brand span{font-weight:750;font-size:14px;letter-spacing:.04em}

    .nav{display:flex; gap:10px; flex-wrap:wrap; justify-content:flex-end; align-items:center;}
    .pill{
      text-decoration:none; color:var(--text);
      padding:9px 14px; border-radius:999px;
      background:rgba(15,19,32,.7);
      border:1px solid var(--border);
      font-size:13px; font-weight:700;
      transition:.2s ease;
      display:inline-flex; align-items:center; gap:8px;
      white-space:nowrap;
    }
    .pill:hover{transform:translateY(-1px); border-color:rgba(125,211,252,.35)}
    .pill strong{font-weight:850}

    /* Layout */
    .container{max-width:1150px;margin:auto;padding:28px 18px 60px}
    .hero{margin-bottom:18px}
    .hero h1{margin:0 0 6px;font-size:clamp(22px,3vw,30px);letter-spacing:.2px}
    .hero p{margin:0;color:var(--muted);font-size:14px;line-height:1.45}

    .panel{
      background:linear-gradient(180deg, rgba(18,22,33,.95), rgba(11,13,18,.85));
      border:1px solid var(--border);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:18px;
    }

    .toolbar{
      display:flex; gap:10px; flex-wrap:wrap; align-items:center; justify-content:space-between;
      margin-bottom:14px;
    }
    .controls{display:flex; gap:10px; flex-wrap:wrap; align-items:center}
    .chip{
      display:inline-flex; align-items:center; gap:8px;
      padding:9px 12px; border-radius:999px;
      background:rgba(255,255,255,.05);
      border:1px solid rgba(255,255,255,.10);
      color:var(--text);
      font-weight:750; font-size:13px;
    }
    select, button{
      font:inherit;
    }
    .select{
      border-radius:999px;
      padding:9px 12px;
      background:rgba(15,19,32,.75);
      border:1px solid rgba(255,255,255,.12);
      color:var(--text);
      font-weight:750;
      outline:none;
    }
    .btn{
      border:1px solid rgba(255,255,255,.14);
      background:rgba(255,255,255,.06);
      color:var(--text);
      padding:10px 14px;
      border-radius:999px;
      font-weight:800;
      font-size:13px;
      cursor:pointer;
      transition:.2s ease;
    }
    .btn:hover{
      transform:translateY(-1px);
      border-color:rgba(125,211,252,.35);
      background:rgba(125,211,252,.10);
    }
    .btn.primary{
      background:linear-gradient(135deg, rgba(125,211,252,.20), rgba(167,139,250,.16));
      border-color:rgba(125,211,252,.30);
    }
    .stats{display:flex; gap:10px; flex-wrap:wrap; justify-content:flex-end}

    /* Board */
    .board{
      display:grid;
      gap:12px;
      padding:12px;
      border-radius:16px;
      background:rgba(255,255,255,.03);
      border:1px solid rgba(255,255,255,.08);
    }

    /* Card flip */
    .card{
      position:relative;
      aspect-ratio: 1/1;
      border-radius:16px;
      border:1px solid rgba(255,255,255,.12);
      background:rgba(15,19,32,.65);
      box-shadow: 0 10px 25px rgba(0,0,0,.25);
      cursor:pointer;
      perspective: 900px;
      overflow:hidden;
      transition: transform .15s ease, border-color .2s ease;
      user-select:none;
    }
    .card:hover{transform:translateY(-2px); border-color:rgba(125,211,252,.35)}
    .card[disabled]{opacity:.55; cursor:not-allowed}
    .inner{
      position:absolute; inset:0;
      transform-style:preserve-3d;
      transition: transform .45s cubic-bezier(.2,.8,.2,1);
    }
    .flipped .inner{transform: rotateY(180deg)}
    .face{
      position:absolute; inset:0;
      display:grid; place-items:center;
      backface-visibility:hidden;
    }
    .front{
      background:
        radial-gradient(120px 120px at 30% 20%, rgba(125,211,252,.16), transparent 60%),
        radial-gradient(120px 120px at 70% 80%, rgba(167,139,250,.14), transparent 60%),
        rgba(15,19,32,.60);
    }
    .front::after{
      content:"";
      position:absolute; inset:-2px;
      background:linear-gradient(135deg, rgba(125,211,252,.14), rgba(167,139,250,.10));
      opacity:.18;
      filter: blur(18px);
    }
    .badge{
      position:relative;
      width:74%;
      height:74%;
      border-radius:18px;
      border:1px solid rgba(255,255,255,.10);
      background:rgba(255,255,255,.03);
      display:grid; place-items:center;
      box-shadow: inset 0 0 0 1px rgba(255,255,255,.04);
    }
    .spark{
      position:absolute;
      width:7px; height:7px; border-radius:999px;
      background:rgba(125,211,252,.9);
      top:14px; right:14px;
      box-shadow:0 0 0 6px rgba(125,211,252,.12);
      opacity:.8;
    }

    .back{
      transform: rotateY(180deg);
      background: linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02));
    }
    .icon{
      width:72%;
      height:72%;
      border-radius:18px;
      display:grid; place-items:center;
      background:rgba(255,255,255,.04);
      border:1px solid rgba(255,255,255,.10);
      box-shadow: inset 0 0 0 1px rgba(255,255,255,.04);
      overflow:hidden;
    }
    .icon img{width:80%; height:80%}

    .matched{
      border-color: rgba(52,211,153,.45) !important;
      box-shadow: 0 12px 35px rgba(52,211,153,.10);
    }
    .matched .front::after{opacity:.08}
    .toast{
      margin-top:12px;
      padding:12px 14px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.12);
      background:rgba(15,19,32,.65);
      color:var(--muted);
      font-size:13px;
      display:flex; align-items:center; justify-content:space-between; gap:10px;
    }
    .toast b{color:var(--text)}
    .toast .ok{color:var(--good); font-weight:900}
    .hidden{display:none !important}

    @media (max-width:520px){
      .brand span{display:none}
      .board{gap:10px; padding:10px}
      .card{border-radius:14px}
    }
  </style>
</head>
<body>

<header>
  <div class="topbar">
    <a href="index.html" class="brand">
      <img src="assets/primary-steps-logo.png" alt="Primary Steps">
      <span>Primary Steps</span>
    </a>
    <nav class="nav">
      <a class="pill" href="index.html">Home</a>
      <a class="pill" href="games.html">Games</a>
      <a class="pill" href="progress.html">Progress</a>
      <a class="pill" href="settings.html">Settings</a>
      <span class="pill" title="Stars">⭐ <strong id="starsCount">0</strong></span>
    </nav>
  </div>
</header>

<main class="container">
  <section class="hero">
    <h1>Memory Match</h1>
    <p>Flip two cards at a time. Find all the matching pairs. Calm, simple, and rewarding.</p>
  </section>

  <section class="panel">
    <div class="toolbar">
      <div class="controls">
        <span class="chip">Mode</span>
        <select id="sizeSel" class="select" aria-label="Board size">
          <option value="3x4">Easy (3 × 4)</option>
          <option value="4x4" selected>Standard (4 × 4)</option>
          <option value="4x5">Challenge (4 × 5)</option>
        </select>
        <button class="btn primary" id="newBtn" type="button">New Game</button>
      </div>
      <div class="stats">
        <span class="chip">Moves: <strong id="moves">0</strong></span>
        <span class="chip">Matches: <strong id="matches">0</strong></span>
      </div>
    </div>

    <div id="board" class="board" aria-label="Memory board"></div>

    <div id="toast" class="toast hidden" role="status" aria-live="polite">
      <div><b>Well done!</b> You found all pairs. <span class="ok">+1 ⭐</span></div>
      <button class="btn" id="playAgain" type="button">Play again</button>
    </div>
  </section>
</main>

<script>
(function(){
  // Stars (shared across site)
  const starsEl = document.getElementById("starsCount");
  const getStars = () => Number(localStorage.getItem("ps_stars") || "0");
  const setStars = (n) => localStorage.setItem("ps_stars", String(n));
  starsEl.textContent = String(getStars());

  // Inline SVG "images" (data URIs) – looks like images but no extra files needed
  const svg = (fill1, fill2, path) => {
    const s = `
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 96 96">
        <defs>
          <linearGradient id="g" x1="0" y1="0" x2="1" y2="1">
            <stop offset="0" stop-color="${fill1}"/>
            <stop offset="1" stop-color="${fill2}"/>
          </linearGradient>
          <filter id="soft" x="-20%" y="-20%" width="140%" height="140%">
            <feGaussianBlur stdDeviation="2.2" result="b"/>
            <feColorMatrix in="b" type="matrix"
              values="1 0 0 0 0
                      0 1 0 0 0
                      0 0 1 0 0
                      0 0 0 .55 0" />
            <feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge>
          </filter>
        </defs>
        <rect x="10" y="10" width="76" height="76" rx="18" fill="url(#g)" opacity="0.95"/>
        <path d="${path}" fill="rgba(255,255,255,.95)" filter="url(#soft)"/>
      </svg>`;
    return "data:image/svg+xml;charset=UTF-8," + encodeURIComponent(s.trim());
  };

  const ICONS = [
    {id:"star",  src: svg("#60a5fa","#a78bfa","M48 20l7 15 16 2-12 11 3 16-14-8-14 8 3-16-12-11 16-2z")},
    {id:"heart", src: svg("#fb7185","#f59e0b","M48 70s-26-14-26-34c0-9 7-16 16-16 6 0 10 3 10 3s4-3 10-3c9 0 16 7 16 16 0 20-26 34-26 34z")},
    {id:"moon",  src: svg("#34d399","#60a5fa","M61 61c-15 0-27-12-27-27 0-6 2-11 5-16-14 4-24 17-24 32 0 18 15 33 33 33 15 0 28-10 32-24-5 3-10 5-16 5z")},
    {id:"cloud", src: svg("#a78bfa","#60a5fa","M64 58H32c-7 0-12-5-12-12s5-12 12-12c2-9 10-15 19-15 11 0 20 9 20 20 6 1 11 6 11 13 0 8-6 13-18 13z")},
    {id:"leaf",  src: svg("#22c55e","#a3e635","M70 30c-18 0-34 12-40 30 18 0 34-12 40-30zM30 64c6-14 20-24 36-26-6 14-20 24-36 26z")},
    {id:"sun",   src: svg("#fbbf24","#fb7185","M48 30a18 18 0 100 36 18 18 0 000-36zm0-12l4 10h-8l4-10zm0 70l4-10h-8l4 10zM18 48l10-4v8l-10-4zm70 0l-10-4v8l10-4zM26 26l9 6-6 6-6-9 3-3zm44 44l-9-6 6-6 6 9-3 3zm44-44l-6 9-6-6 9-6 3 3zM26 70l-3-3 6-9 6 6-9 6z")},
    {id:"fish",  src: svg("#38bdf8","#22c55e","M70 48c-8 10-20 16-34 16-4 0-9-1-12-2l-8 6 4-10c-4-3-6-7-6-10s2-7 6-10l-4-10 8 6c3-1 8-2 12-2 14 0 26 6 34 16zm-40 2a4 4 0 110-8 4 4 0 010 8z")},
    {id:"rocket",src: svg("#60a5fa","#fbbf24","M56 20c-14 6-25 17-31 31l8 8c14-6 25-17 31-31l-8-8zM36 60l-8 8-8-8 8-8 8 8zm20-28l8 8 8-8-8-8-8 8z")}
  ];

  const board = document.getElementById("board");
  const movesEl = document.getElementById("moves");
  const matchesEl = document.getElementById("matches");
  const sizeSel = document.getElementById("sizeSel");
  const newBtn = document.getElementById("newBtn");
  const toast = document.getElementById("toast");
  const playAgain = document.getElementById("playAgain");

  let first = null;
  let lock = false;
  let moves = 0;
  let matches = 0;
  let totalPairs = 0;

  function shuffle(a){
    for(let i=a.length-1;i>0;i--){
      const j = Math.floor(Math.random()*(i+1));
      [a[i],a[j]] = [a[j],a[i]];
    }
    return a;
  }

  function boardDims(){
    const v = sizeSel.value;
    const [r,c] = v.split("x").map(n=>parseInt(n,10));
    return {r,c};
  }

  function pickItems(pairs){
    const pool = shuffle([...ICONS]);
    return pool.slice(0, pairs);
  }

  function resetUI(){
    first = null; lock = false;
    moves = 0; matches = 0;
    movesEl.textContent = "0";
    matchesEl.textContent = "0";
    toast.classList.add("hidden");
  }

  function makeCard(item, key){
    const btn = document.createElement("button");
    btn.type = "button";
    btn.className = "card";
    btn.setAttribute("aria-label", "Memory card");
    btn.dataset.key = key;
    btn.dataset.id = item.id;

    btn.innerHTML = `
      <div class="inner">
        <div class="face front">
          <div class="badge">
            <span class="spark"></span>
          </div>
        </div>
        <div class="face back">
          <div class="icon">
            <img alt="" draggable="false" src="${item.src}">
          </div>
        </div>
      </div>
    `;
    btn.addEventListener("click", () => onFlip(btn));
    return btn;
  }

  function setGrid(r,c){
    board.style.gridTemplateColumns = `repeat(${c}, minmax(0, 1fr))`;
  }

  function newGame(){
    resetUI();

    const {r,c} = boardDims();
    const cells = r*c;
    totalPairs = Math.floor(cells/2);

    setGrid(r,c);

    // Choose items
    const items = pickItems(totalPairs);
    let deck = [];
    items.forEach((it, idx) => {
      deck.push({it, key: idx+"a"});
      deck.push({it, key: idx+"b"});
    });
    deck = shuffle(deck);

    board.innerHTML = "";
    deck.forEach(d => board.appendChild(makeCard(d.it, d.key)));
  }

  function onFlip(card){
    if(lock) return;
    if(card.classList.contains("matched")) return;
    if(card.classList.contains("flipped")) return;

    card.classList.add("flipped");

    if(!first){
      first = card;
      return;
    }

    // second card
    moves += 1;
    movesEl.textContent = String(moves);

    const a = first.dataset.id;
    const b = card.dataset.id;

    if(a === b){
      // match
      first.classList.add("matched");
      card.classList.add("matched");
      matches += 1;
      matchesEl.textContent = String(matches);
      first = null;

      if(matches === totalPairs){
        // reward star
        const s = getStars() + 1;
        setStars(s);
        starsEl.textContent = String(s);
        toast.classList.remove("hidden");
      }
    }else{
      // no match
      lock = true;
      const prev = first;
      first = null;
      setTimeout(() => {
        prev.classList.remove("flipped");
        card.classList.remove("flipped");
        lock = false;
      }, 520);
    }
  }

  newBtn.addEventListener("click", newGame);
  playAgain.addEventListener("click", newGame);
  sizeSel.addEventListener("change", newGame);

  // Start
  newGame();
})();
</script>

</body>
</html>
