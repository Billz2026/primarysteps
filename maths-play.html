<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Maths • Primary Steps</title>
<link rel="icon" href="assets/primary-steps-icon-512.png" />
<style>
:root{
  --bg0:#0b0d12; --bg1:#0f1320;
  --text:#eef2ff; --muted:rgba(238,242,255,.72);
  --line:rgba(255,255,255,.12);
  --accent:#7dd3fc; --accent2:#a78bfa; --good:#34d399; --bad:#fb7185;
  --ring:rgba(125,211,252,.30);
  --shadow:0 18px 40px rgba(0,0,0,.35);
  --r:18px;
  font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0; color:var(--text);
  background:
    radial-gradient(1200px 700px at 20% 10%, rgba(125,211,252,.18), transparent 55%),
    radial-gradient(900px 600px at 80% 0%, rgba(167,139,250,.16), transparent 55%),
    linear-gradient(180deg, var(--bg0), var(--bg1));
  min-height:100vh;
}
header{
  position:sticky; top:0; z-index:10;
  backdrop-filter: blur(10px);
  background: rgba(18,22,33,.72);
  border-bottom:1px solid var(--line);
}
.wrap{max-width:1100px;margin:0 auto;padding:14px 16px;}
.top{display:flex; align-items:center; justify-content:space-between; gap:12px;}
.brand{display:flex; align-items:center; gap:10px; min-width:0; text-decoration:none; color:var(--text);}
.brand img{height:52px;width:auto;display:block; filter: drop-shadow(0 16px 30px rgba(125,211,252,.10));}
.brand .title{font-weight:850; letter-spacing:.2px; font-size:14px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;}
.brand .sub{display:block; font-size:12px; color:var(--muted); margin-top:2px}
nav{display:flex; gap:10px; flex-wrap:wrap; justify-content:flex-end;}
nav a{
  color:var(--text); text-decoration:none; font-weight:700; font-size:13px;
  padding:8px 10px; border-radius:12px;
  border:1px solid transparent; opacity:.92;
}
nav a:hover{border-color:var(--line); background:rgba(255,255,255,.04); opacity:1;}
nav a.active{border-color:rgba(125,211,252,.35); background:rgba(125,211,252,.10); opacity:1;}

.hero{padding:22px 16px 10px;}
.hwrap{max-width:1100px;margin:0 auto;}
h1{margin:0 0 6px; font-size:28px; letter-spacing:-.4px;}
p.lead{margin:0; color:var(--muted); max-width:85ch; font-size:14px; line-height:1.45;}

.grid{
  max-width:1100px; margin:14px auto 28px; padding:0 16px;
  display:grid; grid-template-columns: 1fr; gap:14px;
}

.card{
  background: linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02));
  border:1px solid var(--line);
  border-radius:var(--r);
  box-shadow: var(--shadow);
  overflow:hidden;
}
.card .head{
  padding:14px 14px 10px;
  border-bottom:1px solid var(--line);
  display:flex; align-items:center; justify-content:space-between; gap:10px;
  flex-wrap:wrap;
}
.pill{
  font-size:12px; font-weight:850;
  padding:6px 10px; border-radius:999px;
  background: rgba(125,211,252,.14);
  border:1px solid rgba(125,211,252,.25);
  color: var(--text);
  white-space:nowrap;
}
.body{padding:14px;}
.row{display:flex; gap:10px; flex-wrap:wrap; align-items:center;}
.btn{
  appearance:none; border:1px solid var(--line);
  background: rgba(255,255,255,.05);
  color:var(--text); font-weight:850;
  padding:10px 12px; border-radius:14px;
  cursor:pointer;
  text-decoration:none;
  display:inline-flex; align-items:center; gap:8px;
}
.btn:hover{background: rgba(255,255,255,.08);}
.btn.primary{
  border-color: rgba(125,211,252,.35);
  background: linear-gradient(180deg, rgba(125,211,252,.18), rgba(125,211,252,.07));
}
.field{display:flex; flex-direction:column; gap:6px; min-width:220px;}
label{font-size:12px; color:var(--muted); font-weight:800; letter-spacing:.02em;}
select{
  width:100%;
  appearance:none;
  border:1px solid var(--line);
  background: rgba(255,255,255,.05);
  color:var(--text);
  padding:10px 12px;
  border-radius:14px;
  font-weight:800;
  cursor:pointer;
  outline:none;
}
select:focus{box-shadow: 0 0 0 6px var(--ring);}

.msg{
  padding:10px 12px; border-radius:14px;
  border:1px solid var(--line);
  background: rgba(255,255,255,.04);
  color: var(--muted);
  margin-top:10px;
}
.msg.good{border-color:rgba(52,211,153,.35); background: rgba(52,211,153,.10); color: rgba(238,242,255,.92);}
.msg.bad{border-color:rgba(251,113,133,.35); background: rgba(251,113,133,.10); color: rgba(238,242,255,.92);}

.stage{
  border:1px solid var(--line);
  border-radius:16px;
  padding:14px;
  background:
    radial-gradient(900px 500px at 10% 0%, rgba(125,211,252,.10), transparent 60%),
    linear-gradient(180deg, rgba(13,28,54,.65), rgba(13,28,54,.35));
}
.center{display:flex; flex-direction:column; align-items:center; gap:10px; text-align:center}
.bigQ{font-weight:950; font-size:48px; letter-spacing:.02em}
.inputRow{display:flex; gap:10px; flex-wrap:wrap; justify-content:center; align-items:center}
input[type="number"]{
  width:140px;
  border:1px solid var(--line);
  background: rgba(255,255,255,.06);
  color: var(--text);
  padding:12px 14px;
  border-radius:14px;
  font-weight:950;
  font-size:18px;
  outline:none;
}
input[type="number"]:focus{box-shadow:0 0 0 6px var(--ring);}
.small{font-size:13px; color:var(--muted); line-height:1.35; max-width:70ch}

.choiceGrid{
  display:grid;
  grid-template-columns: repeat(3, minmax(0,1fr));
  gap:10px;
  margin-top:10px;
}
@media (max-width:650px){ .choiceGrid{grid-template-columns:1fr;} }
.choice{
  border:1px solid var(--line);
  background: rgba(255,255,255,.05);
  border-radius:16px;
  padding:14px;
  cursor:pointer;
  user-select:none;
  text-align:left;
  display:flex; align-items:center; justify-content:space-between; gap:10px;
  font-weight:950;
}
.choice:hover{background: rgba(255,255,255,.08);}
.tag{
  font-size:12px; font-weight:950;
  padding:6px 10px; border-radius:999px;
  border:1px solid rgba(255,255,255,.14);
  color: var(--muted);
  background: rgba(0,0,0,.10);
  white-space:nowrap;
}
</style>
</head>
<body>

<header>
  <div class="wrap">
    <div class="top">
      <a class="brand" href="index.html" aria-label="Primary Steps home">
        <img src="assets/primary-steps-logo.png" alt="Primary Steps logo" onerror="this.style.display='none'">
        <div>
          <div class="title">Primary Steps</div>
          <span class="sub">Simple, calm learning activities</span>
        </div>
      </a>
      <nav aria-label="Primary">
        <a href="maths.html" class="active">Back to Maths</a>
        <a href="numbers.html">Numbers</a>
        <a href="games.html">Games</a>
        <a href="progress.html">Progress</a>
      </nav>
    </div>
  </div>
</header>

<section class="hero">
  <div class="hwrap">
    <h1 id="pageTitle">Maths</h1>
    <p class="lead" id="pageLead">Press New to start.</p>
  </div>
</section>

<section class="grid">
  <div class="card" aria-label="Maths activity">
    <div class="head">
      <div class="pill" id="actPill">Loading…</div>
      <div class="row">
        <div class="field">
          <label for="difficulty">Difficulty</label>
          <select id="difficulty">
            <option value="easy">Easy</option>
            <option value="medium" selected>Medium</option>
            <option value="hard">Hard</option>
          </select>
        </div>
        <button class="btn primary" id="newBtn" type="button">New</button>
        <button class="btn" id="checkBtn" type="button">Check</button>
        <button class="btn" id="resetBtn" type="button">Reset</button>
      </div>
    </div>
    <div class="body">
      <div class="stage" id="stage"></div>
      <div class="msg" id="message">Press <strong>New</strong> to start.</div>
    </div>
  </div>
</section>

<script>
(() => {
  const $ = (id)=>document.getElementById(id);
  const ui = {
    stage:$('stage'),
    msg:$('message'),
    pill:$('actPill'),
    difficulty:$('difficulty'),
    newBtn:$('newBtn'),
    checkBtn:$('checkBtn'),
    resetBtn:$('resetBtn'),
    pageTitle:$('pageTitle'),
    pageLead:$('pageLead')
  };

  function setMsg(type, html){
    ui.msg.className = 'msg' + (type ? ' ' + type : '');
    ui.msg.innerHTML = html;
  }
  function randInt(a,b){ return Math.floor(Math.random()*(b-a+1))+a; }
  function shuffle(arr){
    for(let i=arr.length-1;i>0;i--){
      const j=Math.floor(Math.random()*(i+1));
      [arr[i],arr[j]]=[arr[j],arr[i]];
    }
    return arr;
  }

  const ACTIVITIES = [
    {
      key:'quickadd',
      name:'Quick Add',
      lead:'Type the answer, then press Check.',
      build: ()=>({ a:0, b:0, answer:"", done:false }),
      newRound:(st, diff)=>{
        const max = diff==='easy' ? 10 : diff==='hard' ? 50 : 20;
        st.a = randInt(0, max);
        st.b = randInt(0, max);
        st.answer = "";
        st.done = false;
        renderQuestion(st, '+');
        setMsg('', `Solve it and press <strong>Check</strong>.`);
      },
      check:(st)=>{
        if(st.done) return;
        const val = Number(st.answer);
        if(!Number.isFinite(val)) { setMsg('bad', 'Type a number first.'); return; }
        st.done = true;
        if(val === st.a + st.b){
          setMsg('good', `✅ Correct! Press <strong>New</strong> for another.`);
        } else {
          setMsg('bad', `Not quite. The answer was <strong>${st.a + st.b}</strong>. Press <strong>New</strong> to try again.`);
        }
      }
    },
    {
      key:'quicksub',
      name:'Quick Subtract',
      lead:'Type the answer, then press Check.',
      build: ()=>({ a:0, b:0, answer:"", done:false }),
      newRound:(st, diff)=>{
        const max = diff==='easy' ? 10 : diff==='hard' ? 50 : 20;
        let a = randInt(0, max);
        let b = randInt(0, max);
        if(diff!=='hard' && b>a){ [a,b]=[b,a]; } // avoid negatives for easy/medium
        st.a = a; st.b = b;
        st.answer = "";
        st.done = false;
        renderQuestion(st, '−');
        setMsg('', `Solve it and press <strong>Check</strong>.`);
      },
      check:(st)=>{
        if(st.done) return;
        const val = Number(st.answer);
        if(!Number.isFinite(val)) { setMsg('bad', 'Type a number first.'); return; }
        st.done = true;
        if(val === st.a - st.b){
          setMsg('good', `✅ Correct! Press <strong>New</strong> for another.`);
        } else {
          setMsg('bad', `Not quite. The answer was <strong>${st.a - st.b}</strong>. Press <strong>New</strong> to try again.`);
        }
      }
    },
    {
      key:'bonds',
      name:'Number Bonds',
      lead:'Pick the missing number.',
      build: ()=>({ target:10, a:0, missing:0, options:[], done:false }),
      newRound:(st, diff)=>{
        st.target = (diff==='hard') ? 20 : 10;
        st.a = randInt(0, st.target);
        st.missing = st.target - st.a;
        const picks = new Set([st.missing]);
        while(picks.size < 3){
          picks.add(randInt(0, st.target));
        }
        st.options = shuffle([...picks]);
        st.done = false;
        ui.stage.innerHTML = `
          <div class="center">
            <div class="pill">Make ${st.target}</div>
            <div class="bigQ">${st.a} + ? = ${st.target}</div>
            <div class="small">Choose the missing number.</div>
            <div class="choiceGrid" id="choices"></div>
          </div>
        `;
        const wrap = ui.stage.querySelector('#choices');
        st.options.forEach(opt=>{
          const el = document.createElement('div');
          el.className = 'choice';
          el.innerHTML = `<span style="font-size:22px">${opt}</span><span class="tag">Choose</span>`;
          el.addEventListener('click', ()=>{
            if(st.done) return;
            st.done = true;
            if(opt === st.missing){
              setMsg('good', `✅ Correct! Press <strong>New</strong> for another.`);
            } else {
              setMsg('bad', `Not quite. The answer was <strong>${st.missing}</strong>. Press <strong>New</strong> to try again.`);
            }
          });
          wrap.appendChild(el);
        });
        setMsg('', `Pick the missing number.`);
      },
      check:()=>{ /* not used */ }
    }
  ];

  function renderQuestion(st, op){
    ui.stage.innerHTML = `
      <div class="center">
        <div class="pill">${op === '+' ? 'Addition' : 'Subtraction'}</div>
        <div class="bigQ">${st.a} ${op} ${st.b} = ?</div>
        <div class="inputRow">
          <input id="ans" type="number" inputmode="numeric" placeholder="Answer" />
        </div>
        <div class="small">Tip: press <strong>Check</strong> when you’re ready.</div>
      </div>
    `;
    const input = ui.stage.querySelector('#ans');
    input.focus({preventScroll:true});
    input.addEventListener('input', ()=> st.answer = input.value);
    input.addEventListener('keydown', (e)=>{
      if(e.key === 'Enter'){ active.check && active.check(state); }
    });
  }

  const params = new URLSearchParams(location.search);
  const requested = (params.get('activity') || 'quickadd').toLowerCase();
  let active = ACTIVITIES.find(a=>a.key===requested) || ACTIVITIES[0];
  let state = active.build();

  function applyMeta(){
    ui.pill.textContent = active.name;
    ui.pageTitle.textContent = active.name;
    ui.pageLead.textContent = active.lead;
    // hide check button for activities that don't use it
    ui.checkBtn.style.display = (typeof active.check === 'function') ? '' : 'none';
  }
  function newRound(){
    state = active.build();
    active.newRound(state, ui.difficulty.value);
    applyMeta();
  }
  function reset(){
    newRound();
    setMsg('', `Reset done. Press <strong>New</strong> or keep going.`);
  }

  ui.newBtn.addEventListener('click', newRound);
  ui.resetBtn.addEventListener('click', reset);
  ui.checkBtn.addEventListener('click', ()=> active.check && active.check(state));
  ui.difficulty.addEventListener('change', ()=> newRound());

  applyMeta();
  // initial stage
  ui.stage.innerHTML = `<div class="center"><div class="pill">${active.name}</div><div class="small">Press <strong>New</strong> to start.</div></div>`;
})();
</script>
</body>
</html>
